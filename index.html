<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dastan</title>
  <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQuOtIZInlnxZBB-j8kX60T0qNBwXkOAFKmLg&s" type="image/png">
  <style>
    /* ====== style.css (–≤–ª–æ–∂–µ–Ω) ====== */
    :root{
      --bg:#04070a;
      --accent:#7df3ff;
      --accent2:#ff8bd1;
      --glass: rgba(255,255,255,0.06);
      --ui: rgba(255,255,255,0.08);
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(ellipse at center, rgba(7,10,18,1) 0%, var(--bg) 60%);
      color:#e6f7ff;
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    /* Canvas fills screen */
    #game{
      display:block;
      width:100vw;
      height:100vh;
      background: transparent;
    }

    /* UI overlay */
    .ui{
      position:fixed;
      left:16px;
      top:16px;
      display:flex;
      gap:10px;
      align-items:center;
      z-index:20;
    }
    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      backdrop-filter: blur(6px);
      padding:8px 12px;
      border-radius:12px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
      font-weight:600;
      font-size:14px;
      color:#dffcff;
    }
    .controls{position:fixed; right:16px; bottom:16px; background:var(--ui); padding:10px 12px; border-radius:12px; font-size:13px}
    .brand{position:fixed; left:16px; bottom:16px; font-size:12px; color:rgba(255,255,255,0.6)}

    /* small hint pulse */
    .hint{font-size:12px; opacity:0.9}

    /* responsive */
    @media (max-width:700px){
      .panel{font-size:13px}
      .controls{font-size:12px}
    }
  </style>
</head>
<body>
  <!-- –ü–æ–ª–µ –∏–≥—Ä—ã -->
  <canvas id="game"></canvas>

  <!-- –ü—Ä–æ—Å—Ç–æ–π UI -->
  <div class="ui">
    <div class="panel">üî• –°—á—ë—Ç: <span id="score">0</span></div>
    <div class="panel">‚è±Ô∏è –í—Ä–µ–º—è: <span id="time">0</span>s</div>
  </div>
  <div class="controls">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: <b>WASD</b> / <b>–°—Ç—Ä–µ–ª–∫–∏</b> ‚Äî —Å–æ–±–µ—Ä–∏ —ç–Ω–µ—Ä–≥–∏—é</div>
  <div class="brand">dastan.space ‚Ä¢ Dastan: Cosmic Explorer</div>

  <script>
    /* ====== script.js (–≤–ª–æ–∂–µ–Ω) ====== */
    // –õ–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    let w = canvas.width = innerWidth;
    let h = canvas.height = innerHeight;

    // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    let stars = [];
    let particles = [];
    let orbs = [];
    let score = 0;
    let startTime = performance.now();

    const player = {
      x: w/2,
      y: h/2,
      vx:0,
      vy:0,
      speed: 0.25,
      radius: 12,
      angle: 0
    };

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    const keys = {};
    addEventListener('keydown', e=>{ keys[e.key.toLowerCase()]=true; });
    addEventListener('keyup', e=>{ keys[e.key.toLowerCase()]=false; });

    // Resize
    addEventListener('resize', ()=>{
      w = canvas.width = innerWidth;
      h = canvas.height = innerHeight;
    });

    // –ó–≤—ë–∑–¥—ã —Ñ–æ–Ω–æ–≤—ã–µ ‚Äî –ø–∞—Ä—Ä–∞–ª–ª–∞–∫—Å
    function createStars(n=160){
      stars = [];
      for(let i=0;i<n;i++){
        stars.push({
          x: Math.random()*w,
          y: Math.random()*h,
          z: Math.random()*1.5 + 0.2,
          size: Math.random()*1.6
        });
      }
    }

    // –û—Ä–± —ç–Ω–µ—Ä–≥–∏–∏
    function spawnOrb(){
      const r = 8 + Math.random()*10;
      orbs.push({
        x: Math.random()*w,
        y: Math.random()*h,
        r,
        t: 0,
        wobble: Math.random()*Math.PI*2
      });
    }

    // –ß–∞—Å—Ç–∏—Ü—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–±–æ—Ä–∞
    function spawnParticles(x,y,count=18){
      for(let i=0;i<count;i++){
        particles.push({
          x,y,
          vx: (Math.random()-0.5)*4,
          vy: (Math.random()-0.5)*4,
          life: 40 + Math.random()*20
        });
      }
    }

    // And initial
    createStars();
    for(let i=0;i<6;i++) spawnOrb();

    function update(dt){
      // –í—Ä–µ–º—è
      const now = performance.now();
      document.getElementById('time').textContent = Math.floor((now - startTime)/1000);

      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–µ–º
      const accel = 0.02 + Math.min(Math.floor(score/10)*0.005, 0.06);
      if(keys['arrowup']||keys['w']) player.vy -= accel*dt;
      if(keys['arrowdown']||keys['s']) player.vy += accel*dt;
      if(keys['arrowleft']||keys['a']) player.vx -= accel*dt;
      if(keys['arrowright']||keys['d']) player.vx += accel*dt;

      // –¢—Ä–µ–Ω–∏–µ
      player.vx *= 0.995;
      player.vy *= 0.995;

      player.x += player.vx*dt;
      player.y += player.vy*dt;

      // —ç–∫—Ä–∞–Ω-–æ–±—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
      if(player.x < -50) player.x = w+50;
      if(player.x > w+50) player.x = -50;
      if(player.y < -50) player.y = h+50;
      if(player.y > h+50) player.y = -50;

      // –∑–≤–µ–∑–¥—ã —Å–º–µ—â–∞—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä–æ–∫–∞
      stars.forEach(s=>{
        s.x -= player.vx*0.02* (1/s.z);
        s.y -= player.vy*0.02* (1/s.z);
        if(s.x < 0) s.x += w;
        if(s.x > w) s.x -= w;
        if(s.y < 0) s.y += h;
        if(s.y > h) s.y -= h;
      });

      // –æ—Ä–±—ã wobble
      orbs.forEach(o=>{ o.t += 0.02*dt; o.x += Math.sin(o.t+o.wobble)*0.1; o.y += Math.cos(o.t+o.wobble)*0.1 });

      // –∫–æ–ª–ª–∏–∑–∏—è –∏–≥—Ä–æ–∫-–æ—Ä–±
      for(let i=orbs.length-1;i>=0;i--){
        const o = orbs[i];
        const dx = o.x - player.x;
        const dy = o.y - player.y;
        const dist = Math.sqrt(dx*dx+dy*dy);
        if(dist < o.r + player.radius){
          // —Å–æ–±—Ä–∞–ª–∏
          score += 1 + Math.floor(score/15);
          document.getElementById('score').textContent = score;
          spawnParticles(o.x, o.y, 22);
          orbs.splice(i,1);
          // —Å–ª–æ–∂–Ω–µ–µ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º: –ø–æ—è–≤–ª—è—é—Ç—Å—è –±–æ–ª—å—à–µ
          const toSpawn = 1 + Math.floor(score/8);
          for(let k=0;k<toSpawn;k++) spawnOrb();
        }
      }

      // —á–∞—Å—Ç–∏—Ü—ã
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.life -= 1;
        if(p.life <= 0) particles.splice(i,1);
      }

      // –∏–Ω–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –æ—Ä–±
      if(Math.random() < 0.01 + Math.min(score*0.0008, 0.06)) spawnOrb();
    }

    function draw(){
      // —Ñ–æ–Ω –≥—Ä–∞–¥–∏–µ–Ω—Ç
      ctx.clearRect(0,0,w,h);

      // —Å–ª–µ–≥–∫–∞ —Ç—ë–º–Ω—ã–π —Ñ–æ–Ω
      const g = ctx.createLinearGradient(0,0,0,h);
      g.addColorStop(0, '#041226');
      g.addColorStop(1, '#02040a');
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);

      // –∑–≤—ë–∑–¥—ã
      for(const s of stars){
        const alpha = 0.6 / s.z;
        ctx.fillStyle = `rgba(210,240,255,${alpha})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
        ctx.fill();
      }

      // –≥–ª—É–±–∏–Ω–Ω—ã–µ —Å–≤–µ—Ç—è—â–∏–µ—Å—è –æ—Ä–±—ã
      for(const o of orbs){
        const glow = Math.max(0.2, 0.6 + Math.sin(o.t*2)*0.3);
        const rad = o.r;
        // glow
        const rg = ctx.createRadialGradient(o.x, o.y, 0, o.x, o.y, rad*3);
        rg.addColorStop(0, `rgba(125,243,255,${0.28*glow})`);
        rg.addColorStop(0.4, `rgba(125,243,255,${0.14*glow})`);
        rg.addColorStop(1, `rgba(3,6,9,0)`);
        ctx.fillStyle = rg;
        ctx.beginPath(); ctx.arc(o.x, o.y, rad*3,0,Math.PI*2); ctx.fill();
        // core
        ctx.fillStyle = `rgba(125,243,255,${0.95})`;
        ctx.beginPath(); ctx.arc(o.x, o.y, rad*0.9,0,Math.PI*2); ctx.fill();
      }

      // —á–∞—Å—Ç–∏—Ü—ã
      for(const p of particles){
        const a = Math.max(0, Math.min(1, p.life/60));
        ctx.fillStyle = `rgba(255,220,200,${a})`;
        ctx.beginPath(); ctx.arc(p.x, p.y, 2.2,0,Math.PI*2); ctx.fill();
      }

      // —Ä–∏—Å—É–µ–º –∫–æ—Ä–∞–±–ª—å (–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ)
      ctx.save();
      ctx.translate(player.x, player.y);
      const ang = Math.atan2(player.vy, player.vx) || player.angle;
      ctx.rotate(ang + Math.PI/2);

      // thruster glow
      const thr = Math.min(1, Math.hypot(player.vx, player.vy)/2);
      const tg = ctx.createRadialGradient(0,18,0,0,18,40);
      tg.addColorStop(0, `rgba(255,120,60,${0.45*thr})`);
      tg.addColorStop(1, `rgba(255,120,60,0)`);
      ctx.fillStyle = tg;
      ctx.beginPath(); ctx.ellipse(0,18,10,6,0,0,Math.PI*2); ctx.fill();

      // hull
      ctx.fillStyle = '#dffcff';
      ctx.beginPath(); ctx.moveTo(0,-14); ctx.lineTo(10,8); ctx.lineTo(0,4); ctx.lineTo(-10,8); ctx.closePath(); ctx.fill();

      // cockpit
      ctx.fillStyle = '#020a14'; ctx.beginPath(); ctx.ellipse(0,-4,5,3,0,0,Math.PI*2); ctx.fill();

      ctx.restore();

      // subtle HUD center
      ctx.font = '12px Inter, system-ui, Arial';
      ctx.fillStyle = 'rgba(255,255,255,0.04)';
      ctx.textAlign = 'center';
      ctx.fillText('Dastan.space ‚Äî Cosmic Explorer', w/2, h-18);
    }

    // Main loop
    let last = performance.now();
    function loop(now){
      const dt = Math.min(40, now - last);
      update(dt);
      draw();
      last = now;
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    // –ù–∞—á–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç: –ø–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
    const fade = document.createElement('div');
    // small accessibility: click to add impulse
    addEventListener('click', (e)=>{
      // —Ç–æ–ª—á–æ–∫ –≤ —Å—Ç–æ—Ä–æ–Ω—É –∫—É—Ä—Å–æ—Ä–∞
      const dx = e.clientX - player.x;
      const dy = e.clientY - player.y;
      player.vx += dx*0.0006; player.vy += dy*0.0006;
    });

    // –ü—Ä–æ—Å—Ç–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞: –µ—Å–ª–∏ –¥–æ–ª–≥–æ –Ω–µ –¥–≤–∏–≥–∞—é—Ç—Å—è, –ø–æ—è–≤–∏—Ç—Å—è –æ—Ä–± —Ä—è–¥–æ–º
    let idle = 0;
    setInterval(()=>{
      idle++;
      if(idle > 7){
        // spawn nearby
        const nx = (player.x + (Math.random()-0.5)*200 + w) % w;
        const ny = (player.y + (Math.random()-0.5)*200 + h) % h;
        orbs.push({x:nx,y:ny,r: 10 + Math.random()*8, t:0, wobble: Math.random()*10});
        idle = 0;
      }
    }, 1000);

    // reset idle on key
    addEventListener('keydown', ()=>{ idle = 0; });

    // touch controls: simple joystick
    let touchStart = null;
    addEventListener('touchstart', e=>{ touchStart = e.touches[0]; });
    addEventListener('touchmove', e=>{ if(!touchStart) return; const t = e.touches[0]; const dx = t.clientX - touchStart.clientX; const dy = t.clientY - touchStart.clientY; player.vx += dx*0.0006; player.vy += dy*0.0006; touchStart = t; });
    addEventListener('touchend', ()=>{ touchStart=null });

    // small helper: focus canvas
    canvas.tabIndex = 0;
    canvas.style.outline = 'none';
    canvas.addEventListener('mouseenter', ()=> canvas.focus());

    // done
  </script>
</body>
</html>
